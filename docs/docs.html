<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VIBE Protocol | Documentation</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" type="image/svg+xml" href="icons/vibe.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <div class="app-container">
    <!-- Sidebar: Documentation Navigation -->
    <nav class="sidebar glass-panel">
      <div class="logo-area">
        <svg width="28" height="28" viewBox="0 0 64 64"><circle cx="32" cy="32" r="32" fill="#1a1f35"/><path d="M18 42 L32 18 L46 42 Z" fill="#00e0ff"/></svg>
        VIBE Docs
      </div>
      
      <div style="font-size:0.75rem; text-transform:uppercase; color:var(--text-muted); margin-left:12px; margin-top:10px; margin-bottom:5px;">Navigation</div>
      <a href="index.html" class="nav-link">‚Üê Back to Home</a>
      <a href="dashboard.html" class="nav-link" style="color:var(--success);">Launch App</a>

      <div style="font-size:0.75rem; text-transform:uppercase; color:var(--text-muted); margin-left:12px; margin-top:20px; margin-bottom:5px;">Contents</div>
      <a href="#vision" class="nav-link active">Vision & Status</a>
      <a href="#lending" class="nav-link">Lending Core</a>
      <!-- Agrega esto en el sidebar, debajo de Lending Core -->
<a href="#whitepaper" class="nav-link" style="color:var(--warning);">üìú Whitepaper & Math</a>
      <a href="#governance" class="nav-link">Token & Governance</a>
      <a href="#stablecoin" class="nav-link">VIBEUSD Stablecoin</a>
      <a href="#router" class="nav-link">Liquidity Router</a>
      <!-- NUEVO: Enlace al Yellow Paper -->
      <a href="#yellowpaper" class="nav-link" style="color:var(--warning); border-left-color:var(--warning);">‚ö° Protocol Yellow Paper</a>
       <!-- AGREGAR ESTA L√çNEA -->
      <a href="#security" class="nav-link" style="color:var(--danger);">Security & Risk</a> 
      
      <a href="#roadmap" class="nav-link">Roadmap 2025/26</a>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
      
      <header>
        <div>
          <h1 style="margin:0; font-size:1.8rem;">Technical Master Blueprint</h1>
          <p style="margin:4px 0 0 0; color:var(--text-muted);">Architecture v2.0 | Last Updated: December 9, 2025</p>
        </div>
      </header>

      <!-- Section 1: Vision -->
      <section id="vision" class="glass-panel doc-section">
        <h2 class="doc-header">üîπ Protocol Vision</h2>
        <p>VIBE Protocol is architected to be the most advanced, sovereign, and modular DeFi protocol within the EVM and Polkadot ecosystems.</p>
        <p>We combine the efficiency of established lending markets with the resilience of a unified liquidity architecture. VIBE acts as the financial nervous system connecting <strong>Soneium</strong> and <strong>Astar Network</strong>.</p>
        
        <div class="doc-callout">
            <strong>üöÄ Live Status (Dec 9, 2025):</strong><br>
            The protocol is fully operational on <strong>Soneium Mainnet</strong> and <strong>Astar EVM Mainnet</strong>.
        </div>
      </section>

      <!-- Section 2: Lending Layer -->
      <section id="lending" class="glass-panel doc-section">
        <h2 class="doc-header">‚öôÔ∏è 1. Core: Lending Layer (Phase A)</h2>
        <p>The foundation of the protocol, handling asset pools, interest rates, and solvency.</p>
        
        <div class="table-container">
            <table class="doc-table">
                <thead>
                    <tr><th>Contract Module</th><th>Functionality</th><th>Status</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="code-tag">V_cERC20_ExtendedInterest</span></td>
                        <td>Handles ERC-20 markets (mint, redeem, borrow, repay, liquidate). Includes extension for supply/borrow caps and reward hooks.</td>
                        <td><span style="color:var(--success)">‚úÖ Live & Stable</span></td>
                    </tr>
                    <tr>
                        <td><span class="code-tag">V_MasterEnhanced</span></td>
                        <td>The Comptroller V3. Coordinates all markets, calculates account health, and enforces global risk parameters.</td>
                        <td><span style="color:var(--success)">‚úÖ Live & Stable</span></td>
                    </tr>
                    <tr>
                        <td><span class="code-tag">InterestRateModelDynamic</span></td>
                        <td>Modular interest model based on kink utilization curves. Upgradable via governance without market migration.</td>
                        <td><span style="color:var(--success)">‚úÖ Live</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
      </section>

      <!-- Section 3: Governance & Token -->
      <section id="governance" class="glass-panel doc-section">
        <h2 class="doc-header">üß† 2. Governance & VIBE Token (Phase B)</h2>
        <p>Decentralized control and incentives mechanism.</p>

        <ul class="doc-list">
            <li><strong>Token Name:</strong> VIBE Governance Token</li>
            <li><strong>Max Supply:</strong> 1,000,000 VIBE (Soneium)</li>
            <li><strong>Utility:</strong> Voting rights, Boosting rewards, Safety Module staking.</li>
        </ul>

        <h3 style="margin-top:20px; color:var(--text-main);">Tokenomics Distribution</h3>
        <div class="stats-grid" style="margin-top:10px;">
            <div class="stat-card" style="background:rgba(0,0,0,0.2);">
                <h3>Community</h3>
                <div class="stat-value" style="font-size:1.2rem;">60%</div>
                <div style="font-size:0.8rem; color:var(--text-muted);">Lenders, Borrowers, LM</div>
            </div>
            <div class="stat-card" style="background:rgba(0,0,0,0.2);">
                <h3>Treasury</h3>
                <div class="stat-value" style="font-size:1.2rem;">20%</div>
                <div style="font-size:0.8rem; color:var(--text-muted);">Protocol Safety</div>
            </div>
            <div class="stat-card" style="background:rgba(0,0,0,0.2);">
                <h3>Team</h3>
                <div class="stat-value" style="font-size:1.2rem;">0%</div>
                <div style="font-size:0.8rem; color:var(--text-muted);">No allocations</div>
            </div>
            <div class="stat-card" style="background:rgba(0,0,0,0.2);">
                <h3>Eco/Liquidity</h3>
                <div class="stat-value" style="font-size:1.2rem;">20%</div>
                <div style="font-size:0.8rem; color:var(--text-muted);">Cross-chain Reserves</div>
            </div>
        </div>
      </section>

      <!-- Section 4: Stablecoin -->
      <section id="stablecoin" class="glass-panel doc-section">
        <h2 class="doc-header">üíµ 3. Stablecoin Layer ‚Äî VIBEUSD (Phase C)</h2>
        <p>A native, over-collateralized stablecoin mintable directly via the borrow module. Inspired by modern debt-based stablecoin designs.</p>
        
        <ul class="doc-list">
            <li><strong>VIBEUSDStabilityModule (VSM):</strong> Maintains peg via asymmetric mint/burn mechanics and market making.</li>
            <li><strong>Parameters:</strong> 
                <span class="code-tag">LTV Max: 75%</span>, 
                <span class="code-tag">Liquidation Threshold: 80%</span>, 
                <span class="code-tag">Stability Fee: 0.5%</span>.
            </li>
        </ul>
      </section>

      <!-- Section 5: Liquidity Router -->
      <section id="router" class="glass-panel doc-section">
        <h2 class="doc-header">ü™ô 4. Omnipool & Liquidity Router (Phase D)</h2>
        <p>
            <strong>SoneVibeLiquidityRouter:</strong> An internal swap router that seeks the best execution path across SoneSwap, UniswapV3, and Curve.
        </p>
        <p>
            <strong>Omnipool Adapter:</strong> Allows liquidators to instantly swap seized collateral into debt assets within the same transaction, reducing slippage and increasing system health.
        </p>
      </section>
            <!-- ============================================================== -->
      <!-- NUEVA SECCION: YELLOW PAPER (Respuesta a Feedback T√©cnico)     -->
      <!-- ============================================================== -->
      <section id="yellowpaper" class="glass-panel doc-section" style="border-top: 4px solid var(--accent);">
        <h2 class="doc-header">‚ö° Protocol Yellow Paper: Core Logic & Differentiation</h2>
        <p style="color:var(--text-muted); font-size:0.9rem; margin-bottom:20px;">
          Detailed architectural breakdown for researchers and auditors. Defining the VIBE deviation from standard lending forks.
        </p>

        <!-- 1. Genealogy -->
        <h3 style="color:#fff; margin-top:25px;">1. Protocol Genealogy & Security</h3>
        <p>VIBE Finance is not a raw fork. It implements a <strong>Hybrid Architecture</strong>:</p>
        <ul class="doc-list">
            <li><strong>Core Solvency Engine:</strong> Based on <em>Compound V2</em> (Unitroller/Comptroller pattern) for its battle-tested mathematical reliability over 5 years.</li>
            <li><strong>Risk Management:</strong> Implements <em>Aave V3-style</em> caps (Supply Caps, Borrow Caps) and Isolation Mode logic directly into the Comptroller.</li>
            <li><strong>Price Feeds:</strong> Custom oracle wrappers supporting <em>DIA</em> (Astar) and <em>Chainlink</em> (Soneium) with fallback mechanisms.</li>
        </ul>

        <!-- 2. The Internal Cash Innovation -->
        <h3 style="color:#fff; margin-top:25px;">2. Anti-Manipulation: The <code>internalCash</code> Mechanism</h3>
        <p>
            Standard cTokens (Compound V2) rely on <code>balanceOf(address(this))</code> to calculate interest rates. This is vulnerable to <strong>"Donation Attacks"</strong> where an attacker sends underlying tokens directly to the contract to manipulate the exchange rate or force liquidations.
        </p>
        <p>
            <strong>The VIBE Solution (V_cERC20_ExtendedInterest.sol):</strong>
        </p>
        <div style="background:rgba(0,0,0,0.3); padding:15px; border-radius:8px; border:1px solid rgba(255,255,255,0.1); font-family:monospace; font-size:0.85rem; color:var(--success);">
            // Core Innovation in VIBE cTokens<br>
            uint256 public internalCash;<br><br>
            function mint(uint256 amount) external nonReentrant {<br>
            &nbsp;&nbsp;...<br>
            &nbsp;&nbsp;// 1. Calculate actual transfer (Support fee-on-transfer tokens)<br>
            &nbsp;&nbsp;uint256 balanceBefore = ERC20(underlying).balanceOf(this);<br>
            &nbsp;&nbsp;transferFrom(msg.sender, this, amount);<br>
            &nbsp;&nbsp;uint256 received = ERC20(underlying).balanceOf(this) - balanceBefore;<br><br>
            &nbsp;&nbsp;// 2. Sync Internal Accounting<br>
            &nbsp;&nbsp;internalCash += received;<br>
            &nbsp;&nbsp;...<br>
            }
        </div>
        <p style="margin-top:10px;">
            By strictly tracking <code>internalCash</code> on every Mint, Redeem, Borrow, and Repay, VIBE creates a <strong>hermetic accounting system</strong>. External donations are ignored by the interest rate model, protecting users from exchange rate manipulation.
        </p>

        <!-- 3. Real Yield Integration -->
        <h3 style="color:#fff; margin-top:25px;">3. Future Outlook: Startale Vault Routing</h3>
        <p>
            Current lending protocols leave idle liquidity (Cash - Reserves) unproductive.
            Following community feedback (RFC-9213), we are architecting a <strong>Yield Router Module</strong>.
        </p>
        <p>
            <em>Conceptual Logic:</em> Instead of idle capital sitting in the cToken contract earning 0%, the protocol will utilize an "Idle Strategy Strategy" to route excess liquidity into <strong>Startale App Vaults</strong> or <strong>Soneium Staking</strong>, generating 'Real Yield' that flows back to the Reserves, increasing the APY for suppliers organically without token emissions.
        </p>

        <!-- 4. Math Spec -->
        <h3 style="color:#fff; margin-top:25px;">4. Mathematical Specifications</h3>
        <div class="table-container">
            <table class="doc-table">
                <thead><tr><th>Metric</th><th>Formula</th></tr></thead>
                <tbody>
                    <tr>
                        <td><strong>Exchange Rate</strong></td>
                        <td><code>(internalCash + totalBorrows - totalReserves) / totalSupply</code></td>
                    </tr>
                    <tr>
                        <td><strong>Utilization Rate</strong></td>
                        <td><code>totalBorrows / (internalCash + totalBorrows - totalReserves)</code></td>
                    </tr>
                    <tr>
                        <td><strong>Health Factor</strong></td>
                        <td><code>(Œ£ Collateral_USD * LiquidationThreshold) / TotalBorrows_USD</code></td>
                    </tr>
                </tbody>
            </table>
        </div>
      </section>
            <!-- ================================================================= -->
      <!-- NUEVA SECCION: WHITEPAPER & YELLOWPAPER HYBRID -->
      <!-- ================================================================= -->
      <section id="whitepaper" class="glass-panel doc-section">
        <h2 class="doc-header">üìú Protocol Whitepaper & Math Specifications</h2>
        <p style="font-size:1.1rem; color:#fff; margin-bottom:20px;">
          The underlying mathematical models governing the VIBE Protocol solvency, interest rates, and liquidation logic.
        </p>

        <!-- 1. Interest Rate Model -->
        <h3 style="color:var(--accent); border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:8px; margin-top:30px;">1. The Jump Rate Model (Interest Logic)</h3>
        <p>VIBE utilizes a dynamic algorithmic interest rate model derived from the <strong>Utilization Rate (U)</strong> of each market. This ensures liquidity is always available for withdrawals while optimizing yield for suppliers.</p>
        
        <div style="background:rgba(0,0,0,0.3); padding:20px; border-radius:12px; border-left:4px solid var(--accent); margin:15px 0;">
            <p style="margin:0 0 10px 0; font-family:monospace; color:var(--text-muted);">// 1. Utilization Rate Formula</p>
            <div style="font-size:1.2rem; font-weight:bold; color:#fff; font-family:'Times New Roman', serif;">
                U = TotalBorrows / (Cash + TotalBorrows - Reserves)
            </div>
        </div>

        <p>The Borrow Rate changes based on a "Kink" point (optimal utilization). This incentivizes borrowers when liquidity is abundant and protects the protocol when liquidity is scarce.</p>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:15px;">
            <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:8px;">
                <strong style="color:var(--success)">If U < Kink:</strong>
                <p style="font-family:monospace; margin-top:5px; color:#ddd;">Rate = BaseRate + (U * Multiplier)</p>
                <div style="font-size:0.8rem; color:var(--text-muted); margin-top:5px;">Slow increase to encourage borrowing.</div>
            </div>
            <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:8px;">
                <strong style="color:var(--danger)">If U > Kink:</strong>
                <p style="font-family:monospace; margin-top:5px; color:#ddd;">Rate = RateAtKink + (U - Kink) * JumpMultiplier</p>
                <div style="font-size:0.8rem; color:var(--text-muted); margin-top:5px;">Rapid spike to force repayments.</div>
            </div>
        </div>

        <!-- 2. Exchange Rate Logic -->
        <h3 style="color:var(--accent); border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:8px; margin-top:40px;">2. cToken Exchange Rate</h3>
        <p>cTokens (e.g., cASTR) are interest-bearing wrappers. Their value relative to the underlying asset increases every block as interest accrues.</p>
        
        <div style="background:rgba(0,0,0,0.3); padding:20px; border-radius:12px; border-left:4px solid var(--success); margin:15px 0;">
            <div style="font-size:1.1rem; font-weight:bold; color:#fff; font-family:'Times New Roman', serif; line-height:1.5;">
                ExchangeRate = <br>
                (Cash + TotalBorrows - Reserves) / TotalSupply_cTokens
            </div>
        </div>
        <p style="font-size:0.9rem; color:var(--text-muted);">
            * <strong>Cash:</strong> Underlying balance held in the contract.<br>
            * <strong>Reserves:</strong> Protocol profit set aside for safety.
        </p>

        <!-- 3. Liquidation Logic -->
        <h3 style="color:var(--accent); border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:8px; margin-top:40px;">3. Solvency & Liquidation</h3>
        <p>To ensure protocol solvency, accounts with a Health Factor (HF) below 1.0 are subject to liquidation.</p>

        <div style="display:flex; flex-wrap:wrap; gap:20px; margin-top:15px;">
            <div style="flex:1; min-width:250px; background:rgba(255, 85, 85, 0.1); border:1px solid var(--danger); padding:20px; border-radius:12px;">
                <h4 style="margin:0 0 10px 0; color:var(--danger);">Health Factor Formula</h4>
                <div style="font-size:1.2rem; font-weight:bold; color:#fff;">HF = ( Œ£ Collateral_i * CF_i ) / TotalBorrows_USD</div>
                <ul style="font-size:0.85rem; color:var(--text-muted); margin-top:10px; padding-left:20px;">
                    <li><strong>Collateral_i:</strong> Value of asset i in USD.</li>
                    <li><strong>CF_i:</strong> Collateral Factor (e.g., 0.75 for ASTR).</li>
                </ul>
            </div>
            
            <div style="flex:1; min-width:250px; background:rgba(249, 224, 97, 0.1); border:1px solid var(--warning); padding:20px; border-radius:12px;">
                <h4 style="margin:0 0 10px 0; color:var(--warning);">Liquidation Incentive</h4>
                <p style="font-size:0.9rem;">
                    When HF < 1.0, liquidators repay up to 50% of the debt (Close Factor) and receive collateral plus a bonus.
                </p>
                <div style="font-weight:bold; color:#fff; margin-top:5px;">
                    Bonus (Incentive): 8% - 10%
                </div>
                <p style="font-size:0.8rem; color:var(--text-muted); margin-top:5px;">
                    Calculated as: <code>SeizeAmount = RepayAmount * (1 + Incentive)</code>
                </p>
            </div>
        </div>

      </section>
            <!-- [NUEVA SECCION] Security & Risk Architecture -->
      <section id="security" class="glass-panel doc-section" style="border-left: 4px solid var(--danger);">
        <h2 class="doc-header">üõ°Ô∏è 5. Security Architecture (The Nucleus)</h2>
        <p>VIBE Protocol implements a proprietary "Defense-in-Depth" security model designed to protect against modern DeFi vectors like donation attacks and price manipulation.</p>

        <h3 style="margin-top:20px; font-size:1.1rem; color:#fff;">A. The Nucleus Mechanism (`internalCash`)</h3>
        <p>
            Unlike standard lending forks that rely on <code>balanceOf(this)</code>, VIBE uses an isolated accounting variable called <span class="code-tag">internalCash</span>. 
        </p>
        <ul class="doc-list">
            <li><strong>Anti-Inflation:</strong> Prevents attackers from artificially inflating the exchange rate by sending direct token transfers to the contract.</li>
            <li><strong>Donation Sweep:</strong> Any surplus tokens sent to the contract (donations) are separated from the lending pool and routed to the <strong>Protocol Reserves</strong> via the <code>sweepDonations()</code> function, benefitting VIBE stakers instead of attackers.</li>
        </ul>

        <h3 style="margin-top:20px; font-size:1.1rem; color:#fff;">B. Guarded Launch Parameters</h3>
        <div class="table-container">
            <table class="doc-table">
                <thead>
                    <tr><th>Security Module</th><th>Description</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Supply/Borrow Caps</strong></td>
                        <td>Hard limits on total liquidity per asset. Prevents infinite minting attacks or over-exposure to a single asset class.</td>
                    </tr>
                    <tr>
                        <td><strong>Guardian Pauses</strong></td>
                        <td>The <code>PauseGuardian</code> multisig can instantly freeze Minting, Borrowing, or Liquidations globally or per market in case of on-chain anomalies.</td>
                    </tr>
                    <tr>
                        <td><strong>Oracle Thresholds</strong></td>
                        <td>Price updates are rejected if they deviate >20% from the previous checkpoint without manual validation (Circuit Breaker).</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3 style="margin-top:20px; font-size:1.1rem; color:#fff;">C. Asset Listing Strategy</h3>
        <p>We prioritize solvency over volume. New assets are listed in tiers:</p>
        <ol style="color:var(--text-muted); padding-left:20px; line-height:1.6;">
            <li><strong>Tier 1 (Live):</strong> Majors & Native Gas (ASTR, USDC). Max LTV: 75%. (ASTR LTV: 30% DOT LTV: 60%)</li>
            <li><strong>Tier 2 (Upcoming):</strong> Bridged Bluechips (WBTC, WETH). Requires 30-day bridge stability.</li>
            <li><strong>Tier 3 (Governance):</strong> Ecosystem tokens (LSDs, DEX Gov tokens). Isolated mode with Debt Ceilings.</li>
        </ol>
      </section>


      <!-- Section 6: Roadmap -->
      <section id="roadmap" class="glass-panel doc-section" style="border-top: 4px solid var(--warning);">
        <h2 class="doc-header">üß≠ Roadmap 2025 ‚Äì 2026</h2>
        <div class="doc-timeline">
            <div class="timeline-item">
                <div class="timeline-date">Q1 2025 (Completed)</div>
                <div class="timeline-content">Consolidate Lending Core (cERC20 + cNative + Comptroller V3 Fixed).</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">Q2 2025 (Completed)</div>
                <div class="timeline-content">VIBE Token Launch + Governance DAO activation.</div>
            </div>
            <div class="timeline-item active">
                <div class="timeline-date" style="color:var(--success)">Q3-Q4 2025 (Current)</div>
                <div class="timeline-content">
                    Integration of VIBEUSD Stablecoin & Treasury System.<br>
                    Deployment of Omnipool Router and Oracle Hub.
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">Q1 2026</div>
                <div class="timeline-content">Cross-chain Bridge Layer (Soneium ‚Üî Astar). RiskManager AI Beta.</div>
            </div>
        </div>
      </section>

      <section class="glass-panel doc-section" style="text-align:center;">
        <h3 style="color:var(--accent);">‚ÄúLiquidity is life.‚Äù</h3>
        <p style="max-width:600px; margin:0 auto; color:var(--text-muted);">
            SoneVibe is becoming the financial nervous system between Soneium, Astar, and Polkadot ‚Äî a network where collateral, credit, and governance flow freely with total transparency.
        </p>
      </section>

    </div> 
  </div>

</body>
</html>
